for (i in 1:loops) {
set.seed(i)
method.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100)
method.ds2 <- data.frame(df = 5, MSE = method.data[,1])
method.ds <- rbind(method.ds, method.ds2)
ignore.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, weights = "wgt", N = 5100)
ignore.ds2 <- data.frame(df = 5, MSE = ignore.data[,1])
ignore.ds <- rbind(ignore.ds, ignore.ds2)
}
ignore.ds$df <- as.factor(ignore.ds$df)
method.ds$df <- as.factor(method.ds$df)
plot1 <- ggplot(data = ignore.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Ignoring Survey Design") +
ylim(16000, 18000)
# Making a ggplot object for the MSEs where the Cluster function was used on SRS samples
plot2 <- ggplot(data = method.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Taking Into Account the Survey Design") +
ylim(16000, 18000)
# Making a grid display of the four plot objects above
grid.arrange(plot1,plot2, ncol = 2)
}
income.year_edu.plot(loops = 100)
income.year_edu.plot <- function(loops) {
# Making an empty data set for output when we use SRS samples and make SRS folds
method.ds <- data.frame(MSE = c())
# Making an empty data set for output when we use SRS samples and make Cluster folds
ignore.ds <- data.frame(MSE = c())
# Making an empty data set for output when we use Cluster samples and make Cluster folds
# Making as many simple random samples as we specify for 'loops'
for (i in 1:loops) {
set.seed(i)
method.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100)
method.ds2 <- data.frame(df = 5, MSE = method.data[,1])
method.ds <- rbind(method.ds, method.ds2)
ignore.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, weights = "wgt", N = 5100)
ignore.ds2 <- data.frame(df = 5, MSE = ignore.data[,1])
ignore.ds <- rbind(ignore.ds, ignore.ds2)
}
ignore.ds$df <- as.factor(ignore.ds$df)
method.ds$df <- as.factor(method.ds$df)
plot1 <- ggplot(data = ignore.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Ignoring Survey Design") +
# Making a ggplot object for the MSEs where the Cluster function was used on SRS samples
plot2 <- ggplot(data = method.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Taking Into Account the Survey Design") +
# Making a grid display of the four plot objects above
grid.arrange(plot1,plot2, ncol = 2)
}
income.year_edu.plot(loops = 100)
income.year_edu.plot <- function(loops) {
# Making an empty data set for output when we use SRS samples and make SRS folds
method.ds <- data.frame(MSE = c())
# Making an empty data set for output when we use SRS samples and make Cluster folds
ignore.ds <- data.frame(MSE = c())
# Making an empty data set for output when we use Cluster samples and make Cluster folds
# Making as many simple random samples as we specify for 'loops'
for (i in 1:loops) {
set.seed(i)
method.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100)
method.ds2 <- data.frame(df = 5, MSE = method.data[,1])
method.ds <- rbind(method.ds, method.ds2)
ignore.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, weights = "wgt", N = 5100)
ignore.ds2 <- data.frame(df = 5, MSE = ignore.data[,1])
ignore.ds <- rbind(ignore.ds, ignore.ds2)
}
ignore.ds$df <- as.factor(ignore.ds$df)
method.ds$df <- as.factor(method.ds$df)
plot1 <- ggplot(data = ignore.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Ignoring Survey Design")
# Making a ggplot object for the MSEs where the Cluster function was used on SRS samples
plot2 <- ggplot(data = method.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Taking Into Account the Survey Design")
# Making a grid display of the four plot objects above
grid.arrange(plot1,plot2, ncol = 2)
}
income.year_edu.plot(loops = 100)
income.year_edu.plot <- function(loops) {
# Making an empty data set for output when we use SRS samples and make SRS folds
method.ds <- data.frame(MSE = c())
# Making an empty data set for output when we use SRS samples and make Cluster folds
ignore.ds <- data.frame(MSE = c())
# Making an empty data set for output when we use Cluster samples and make Cluster folds
# Making as many simple random samples as we specify for 'loops'
for (i in 1:loops) {
set.seed(i)
method.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100)
method.ds2 <- data.frame(df = 5, MSE = method.data[,1])
method.ds <- rbind(method.ds, method.ds2)
ignore.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, weights = "wgt", N = 5100)
ignore.ds2 <- data.frame(df = 5, MSE = ignore.data[,1])
ignore.ds <- rbind(ignore.ds, ignore.ds2)
}
ignore.ds$df <- as.factor(ignore.ds$df)
method.ds$df <- as.factor(method.ds$df)
plot1 <- ggplot(data = ignore.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Ignoring Survey Design") +
ylim(18000, 19000)
# Making a ggplot object for the MSEs where the Cluster function was used on SRS samples
plot2 <- ggplot(data = method.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Taking Into Account the Survey Design") +
ylim(18000, 19000)
# Making a grid display of the four plot objects above
grid.arrange(plot1,plot2, ncol = 2)
}
income.year_edu.plot(loops = 100)
income.year_edu.plot <- function(loops) {
# Making an empty data set for output when we use SRS samples and make SRS folds
method.ds <- data.frame(MSE = c())
# Making an empty data set for output when we use SRS samples and make Cluster folds
ignore.ds <- data.frame(MSE = c())
# Making an empty data set for output when we use Cluster samples and make Cluster folds
# Making as many simple random samples as we specify for 'loops'
for (i in 1:loops) {
set.seed(i)
method.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100)
method.ds2 <- data.frame(df = 5, MSE = method.data[,1])
method.ds <- rbind(method.ds, method.ds2)
ignore.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, weights = "wgt", N = 5100)
ignore.ds2 <- data.frame(df = 5, MSE = ignore.data[,1])
ignore.ds <- rbind(ignore.ds, ignore.ds2)
}
ignore.ds$df <- as.factor(ignore.ds$df)
method.ds$df <- as.factor(method.ds$df)
plot1 <- ggplot(data = ignore.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Ignoring Survey Design") +
ylim(18500, 19000)
# Making a ggplot object for the MSEs where the Cluster function was used on SRS samples
plot2 <- ggplot(data = method.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Taking Into Account the Survey Design") +
ylim(18500, 19000)
# Making a grid display of the four plot objects above
grid.arrange(plot1,plot2, ncol = 2)
}
income.year_edu.plot(loops = 1000)
income.year_edu.plot <- function(loops) {
# Making an empty data set for output when we use SRS samples and make SRS folds
method.ds <- data.frame(MSE = c())
# Making an empty data set for output when we use SRS samples and make Cluster folds
ignore.ds <- data.frame(MSE = c())
# Making an empty data set for output when we use Cluster samples and make Cluster folds
# Making as many simple random samples as we specify for 'loops'
for (i in 1:loops) {
set.seed(i)
method.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100)
method.ds2 <- data.frame(df = 5, MSE = method.data[,1])
method.ds <- rbind(method.ds, method.ds2)
ignore.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, weights = "wgt", N = 5100)
ignore.ds2 <- data.frame(df = 5, MSE = ignore.data[,1])
ignore.ds <- rbind(ignore.ds, ignore.ds2)
}
ignore.ds$df <- as.factor(ignore.ds$df)
method.ds$df <- as.factor(method.ds$df)
plot1 <- ggplot(data = ignore.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Ignoring Survey Design") +
ylim(16000, 19000)
# Making a ggplot object for the MSEs where the Cluster function was used on SRS samples
plot2 <- ggplot(data = method.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Taking Into Account the Survey Design") +
ylim(16000, 19000)
# Making a grid display of the four plot objects above
grid.arrange(plot1,plot2, ncol = 2)
}
income.year_edu.plot(loops = 1000)
income.year_edu.plot(loops = 100)
income.year_edu.plot <- function(loops) {
# Making an empty data set for output when we use SRS samples and make SRS folds
method.ds <- data.frame(MSE = c())
# Making an empty data set for output when we use SRS samples and make Cluster folds
ignore.ds <- data.frame(MSE = c())
# Making an empty data set for output when we use Cluster samples and make Cluster folds
# Making as many simple random samples as we specify for 'loops'
for (i in 1:loops) {
set.seed(i)
method.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100)
method.ds2 <- data.frame(df = 5, MSE = method.data[,1])
method.ds <- rbind(method.ds, method.ds2)
ignore.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, weights = "wgt", N = 5100)
ignore.ds2 <- data.frame(df = 5, MSE = ignore.data[,1])
ignore.ds <- rbind(ignore.ds, ignore.ds2)
}
ignore.ds$df <- as.factor(ignore.ds$df)
method.ds$df <- as.factor(method.ds$df)
plot1 <- ggplot(data = ignore.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Ignoring Survey Design") +
ylim(18000, 19000)
# Making a ggplot object for the MSEs where the Cluster function was used on SRS samples
plot2 <- ggplot(data = method.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Taking Into Account the Survey Design") +
ylim(18000, 19000)
# Making a grid display of the four plot objects above
grid.arrange(plot1,plot2, ncol = 2)
}
income.year_edu.plot(loops = 100)
income.year_edu.plot(loops = 1000)
income.year_edu.plot(loops = 100)
income.race.plot <- function(loops) {
# Making an empty data set for output when we take into consideration the design method
method.ds <- data.frame(MSE = c())
# Making an empty data set for output when we ignore the design method
ignore.ds <- data.frame(MSE = c())
# looping and generating MSEs
for (i in 1:loops) {
set.seed(i)
method.data <- cv.svy(NSFG_data, "income~race", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100)
method.ds2 <- data.frame(df = 5, MSE = method.data[,1])
method.ds <- rbind(method.ds, method.ds2)
ignore.data <- cv.svy(NSFG_data, "income~race", nfolds = 4, weights = "wgt", N = 5100)
ignore.ds2 <- data.frame(df = 5, MSE = ignore.data[,1])
ignore.ds <- rbind(ignore.ds, ignore.ds2)
}
ignore.ds$df <- as.factor(ignore.ds$df)
method.ds$df <- as.factor(method.ds$df)
plot1 <- ggplot(data = ignore.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Ignoring Survey Design") +
ylim(18000, 19000)
# Making a ggplot object for the MSE spread comparison
plot2 <- ggplot(data = method.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Taking Into Account the Survey Design") +
ylim(18000, 19000)
# Making a grid display of the two plot objects above
grid.arrange(plot1,plot2, ncol = 2)
}
income.race.plot(loops = 100)
income.race.plot <- function(loops) {
# Making an empty data set for output when we take into consideration the design method
method.ds <- data.frame(MSE = c())
# Making an empty data set for output when we ignore the design method
ignore.ds <- data.frame(MSE = c())
# looping and generating MSEs
for (i in 1:loops) {
set.seed(i)
method.data <- cv.svy(NSFG_data, "income~race", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100)
method.ds2 <- data.frame(df = 5, MSE = method.data[,1])
method.ds <- rbind(method.ds, method.ds2)
ignore.data <- cv.svy(NSFG_data, "income~race", nfolds = 4, weights = "wgt", N = 5100)
ignore.ds2 <- data.frame(df = 5, MSE = ignore.data[,1])
ignore.ds <- rbind(ignore.ds, ignore.ds2)
}
ignore.ds$df <- as.factor(ignore.ds$df)
method.ds$df <- as.factor(method.ds$df)
plot1 <- ggplot(data = ignore.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Ignoring Survey Design")
#ylim(18000, 19000)
# Making a ggplot object for the MSE spread comparison
plot2 <- ggplot(data = method.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Taking Into Account the Survey Design")
#ylim(18000, 19000)
# Making a grid display of the two plot objects above
grid.arrange(plot1,plot2, ncol = 2)
}
income.race.plot(loops = 100)
# we see a significant difference here
income.year_edu.plot(loops = 100)
income.year_edu.plot <- function(loops) {
# Making an empty data set for output when we take into consideration the design method
method.ds <- data.frame(MSE = c())
# Making an empty data set for output when we ignore the design method
ignore.ds <- data.frame(MSE = c())
#Making an empty dataset for output when we take into account everything except during fold generation
method-fold.ds <- data.frame(MSE = c())
# looping and generating MSEs
for (i in 1:loops) {
set.seed(i)
method.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100)
method.ds2 <- data.frame(df = 5, MSE = method.data[,1])
method.ds <- rbind(method.ds, method.ds2)
ignore.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, weights = "wgt", N = 5100)
ignore.ds2 <- data.frame(df = 5, MSE = ignore.data[,1])
ignore.ds <- rbind(ignore.ds, ignore.ds2)
method-fold.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100, afolds = "FALSE")
method-fold.ds2 <- data.frame(df = 5, MSE = method.data[,1])
method-fold.ds <- rbind(method.ds, method.ds2)
}
ignore.ds$df <- as.factor(ignore.ds$df)
method.ds$df <- as.factor(method.ds$df)
method-fold.ds$df <- as.factor(method-fold.ds$df)
# Making a ggplot object for the MSE spread comparison
plot1 <- ggplot(data = ignore.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Ignoring Survey Design") +
ylim(18000, 19000)
plot2 <- ggplot(data = method-fold.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Taking Into Account the Survey Design except during folds") +
ylim(18000, 19000)
plot3 <- ggplot(data = method.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Taking Into Account the Survey Design") +
ylim(18000, 19000)
# Making a grid display of the two plot objects above
grid.arrange(plot1,plot2,plot3, ncol = 3)
}
# we see a significant difference here
income.year_edu.plot(loops = 100)
income.year_edu.plot <- function(loops) {
# Making an empty data set for output when we take into consideration the design method
method.ds <- data.frame(MSE = c())
# Making an empty data set for output when we ignore the design method
ignore.ds <- data.frame(MSE = c())
#Making an empty dataset for output when we take into account everything except during fold generation
method.fold.ds <- data.frame(MSE = c())
# looping and generating MSEs
for (i in 1:loops) {
set.seed(i)
method.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100)
method.ds2 <- data.frame(df = 5, MSE = method.data[,1])
method.ds <- rbind(method.ds, method.ds2)
ignore.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, weights = "wgt", N = 5100)
ignore.ds2 <- data.frame(df = 5, MSE = ignore.data[,1])
ignore.ds <- rbind(ignore.ds, ignore.ds2)
method-fold.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100, afolds = "FALSE")
method.fold.ds2 <- data.frame(df = 5, MSE = method.data[,1])
method.fold.ds <- rbind(method.ds, method.ds2)
}
ignore.ds$df <- as.factor(ignore.ds$df)
method.ds$df <- as.factor(method.ds$df)
method.fold.ds$df <- as.factor(method.fold.ds$df)
# Making a ggplot object for the MSE spread comparison
plot1 <- ggplot(data = ignore.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Ignoring Survey Design") +
ylim(18000, 19000)
plot2 <- ggplot(data = method.fold.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Taking Into Account the Survey Design except during folds") +
ylim(18000, 19000)
plot3 <- ggplot(data = method.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Taking Into Account the Survey Design") +
ylim(18000, 19000)
# Making a grid display of the two plot objects above
grid.arrange(plot1,plot2,plot3, ncol = 3)
}
# we see a significant difference here
income.year_edu.plot(loops = 100)
income.year_edu.plot <- function(loops) {
# Making an empty data set for output when we take into consideration the design method
method.ds <- data.frame(MSE = c())
# Making an empty data set for output when we ignore the design method
ignore.ds <- data.frame(MSE = c())
#Making an empty dataset for output when we take into account everything except during fold generation
method.fold.ds <- data.frame(MSE = c())
# looping and generating MSEs
for (i in 1:loops) {
set.seed(i)
method.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100)
method.ds2 <- data.frame(df = 5, MSE = method.data[,1])
method.ds <- rbind(method.ds, method.ds2)
ignore.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, weights = "wgt", N = 5100)
ignore.ds2 <- data.frame(df = 5, MSE = ignore.data[,1])
ignore.ds <- rbind(ignore.ds, ignore.ds2)
method.fold.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100, afolds = "FALSE")
method.fold.ds2 <- data.frame(df = 5, MSE = method.fold.data[,1])
method.fold.ds <- rbind(method.ds, method.ds2)
}
ignore.ds$df <- as.factor(ignore.ds$df)
method.ds$df <- as.factor(method.ds$df)
method.fold.ds$df <- as.factor(method.fold.ds$df)
# Making a ggplot object for the MSE spread comparison
plot1 <- ggplot(data = ignore.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Ignoring Survey Design") +
ylim(18000, 19000)
plot2 <- ggplot(data = method.fold.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Taking Into Account the Survey Design except during folds") +
ylim(18000, 19000)
plot3 <- ggplot(data = method.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("MSEs When Taking Into Account the Survey Design") +
ylim(18000, 19000)
# Making a grid display of the two plot objects above
grid.arrange(plot1,plot2,plot3, ncol = 3)
}
# we see a significant difference here
income.year_edu.plot(loops = 100)
income.year_edu.plot <- function(loops) {
# Making an empty data set for output when we take into consideration the design method
method.ds <- data.frame(MSE = c())
# Making an empty data set for output when we ignore the design method
ignore.ds <- data.frame(MSE = c())
#Making an empty dataset for output when we take into account everything except during fold generation
method.fold.ds <- data.frame(MSE = c())
# looping and generating MSEs
for (i in 1:loops) {
set.seed(i)
method.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100)
method.ds2 <- data.frame(df = 5, MSE = method.data[,1])
method.ds <- rbind(method.ds, method.ds2)
ignore.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, weights = "wgt", N = 5100)
ignore.ds2 <- data.frame(df = 5, MSE = ignore.data[,1])
ignore.ds <- rbind(ignore.ds, ignore.ds2)
method.fold.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100, afolds = "FALSE")
method.fold.ds2 <- data.frame(df = 5, MSE = method.fold.data[,1])
method.fold.ds <- rbind(method.ds, method.ds2)
}
ignore.ds$df <- as.factor(ignore.ds$df)
method.ds$df <- as.factor(method.ds$df)
method.fold.ds$df <- as.factor(method.fold.ds$df)
# Making a ggplot object for the MSE spread comparison
plot1 <- ggplot(data = ignore.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("Ignoring Design") +
ylim(18000, 19000)
plot2 <- ggplot(data = method.fold.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("No Folds") +
ylim(18000, 19000)
plot3 <- ggplot(data = method.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("Accounting for Design") +
ylim(18000, 19000)
# Making a grid display of the two plot objects above
grid.arrange(plot1,plot2,plot3, ncol = 3)
}
income.year_edu.plot <- function(loops) {
# Making an empty data set for output when we take into consideration the design method
method.ds <- data.frame(MSE = c())
# Making an empty data set for output when we ignore the design method
ignore.ds <- data.frame(MSE = c())
#Making an empty dataset for output when we take into account everything except during fold generation
method.fold.ds <- data.frame(MSE = c())
# looping and generating MSEs
for (i in 1:loops) {
set.seed(i)
method.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100)
method.ds2 <- data.frame(df = 5, MSE = method.data[,1])
method.ds <- rbind(method.ds, method.ds2)
ignore.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, weights = "wgt", N = 5100)
ignore.ds2 <- data.frame(df = 5, MSE = ignore.data[,1])
ignore.ds <- rbind(ignore.ds, ignore.ds2)
method.fold.data <- cv.svy(NSFG_data, "income~ns(YrEdu, df = 5)", nfolds = 4, strataID = "strata",
clusterID = "SECU", nest = TRUE, weights = "wgt", N = 5100, afolds = FALSE)
method.fold.ds2 <- data.frame(df = 5, MSE = method.fold.data[,1])
method.fold.ds <- rbind(method.ds, method.ds2)
}
ignore.ds$df <- as.factor(ignore.ds$df)
method.ds$df <- as.factor(method.ds$df)
method.fold.ds$df <- as.factor(method.fold.ds$df)
# Making a ggplot object for the MSE spread comparison
plot1 <- ggplot(data = ignore.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("Ignoring Design") +
ylim(18000, 19000)
plot2 <- ggplot(data = method.fold.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("No Folds") +
ylim(18000, 19000)
plot3 <- ggplot(data = method.ds, mapping = aes(x = df, y = MSE)) +
geom_boxplot() +
ggtitle("Accounting for Design") +
ylim(18000, 19000)
# Making a grid display of the two plot objects above
grid.arrange(plot1,plot2,plot3, ncol = 3)
}
# we see a significant difference here
income.year_edu.plot(loops = 10)
# we see a significant difference here
income.year_edu.plot(loops = 100)
document()
library(devtools)
document()
document()
library(surveyCV)
library(surveyCV)
library(surveyCV)
data("NSFG_data")
library(devtools)
?usethis::use_data()
?usethis::use_data(NSF_data)
usethis::use_data(NSF_data)
usethis::use_data(NSFG_data)
load("~/Desktop/surveyCV/data/NSFG_data.rda")
load("~/Desktop/surveyCV/data/NSFG_data.rda")
View(NSFG_data)
library(surveyCV)
